{% extends "base-tornado.html" %}
{% autoescape None %}

{%  block headers %}
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" xmlns="http://www.w3.org/1999/html"
      xmlns="http://www.w3.org/1999/html"/>
<title>eve trading</title>
<link href="{{ static_url('portfolio\chart.css') }}" rel="stylesheet">
<link href="{{ static_url('portfolio\portfolio.css') }}" rel="stylesheet">
{% end %}

{% block content %}
<div class="container" ng-app="portfolio">

    <div class="row" style="height: 50px"></div>

    <p>Tips: Drag your stocks around rearrange it however you like</p>

    <!-- If the user is not logged in, show generic home page -->
    <div id="portfolioList" ng-model="portfolios">

        {% for portfolio in portfolios %}
        <div class="row portfolio-row" id="{{portfolio}}">
            <div class="col-lg-2 summary">
                <strong style="font-size: 200%"><a>{{portfolio.name}}</a></strong>
                <strong style="font-size: 200%">(Portfolio)</strong>
                <br>
            </div>
            <div class="col-lg-5" style="padding: 0">
                <!-- <canvas class="chart" width="300px" height="120px"></canvas> -->
            </div>
            <div class="col-lg-4 news" style="padding-left: 20px">
                <p><strong>Something</strong></p>
            </div>
            <div class="col-lg-1 options">
                <p><a>Edit</a></p>
                <p class="delete"><a>Delete</a></p>
            </div>
            <div class="col-lg-12">
                <hr>
            </div>
        </div>
        {% end %}

    </div> <!-- portfolioList -->

    <div id="stocksList" class="panel-group" ng-controller="stockController" ng-init='init( {{jsonpickle.encode(stocks)}} )'>
            <div class="row stock-row panel panel-default" id={{!stock.ticker}} ng-repeat="stock in stocks">
                <div class="panel-heading">
                    <div data-toggle="collapse" data-target={{!"#"+stock.ticker+"panel"}} href={{!"#"+stock.ticker+"panel"}} class="collapsed">
                        <a href={{!"/stock/"+stock.ticker}}><strong style="width: 100px">{{!stock.ticker}}</strong></a>
                        <strong>&nbsp;&nbsp;&nbsp;</strong> <!-- TODO: temporary measure -->
                        <strong style='font-size: 100%' ng-model="closePrice">{{!stock.closePrice}}</strong>
                        <strong>&nbsp;&nbsp;&nbsp;</strong> <!-- TODO: temporary measure -->
                        <strong ng-style="{color: stock.changePriceColor}" ng-model="changePrice">{{!stock.changePrice}}</strong>
                    </div>
                </div>

                <div id={{!stock.ticker+"panel"}} class="panel-collapse collapse">

                <div class="col-lg-7 chart" id={{!stock.ticker+"chart"}}></div>

                <div class="col-lg-4 news" style="padding-left: 20px">
                    <p><strong>{{!stock.ticker}} News</strong></p>
                    <ul id="newsList"></ul>
                    <div class="col-lg-2">
                        <div id="newsNext" style="cursor: pointer">Prev</div>
                    </div>
                    <div class="col-lg-2">
                        <div id="newsPrev" style="cursor: pointer">Next</div>
                    </div>
                </div>
                <div class="col-lg-1 options">
                    <p><a>Edit</a></p>
                    <p class="delete"><a>Delete</a></p>
                </div>
                </div>
            </div>
           <hr style="margin-top: 7px; margin-bottom: 7px; border-top: 0px">
    </div>	<!-- stocksList -->

    <div style="height:50px"></div>

</div>



{% end %}

{% block footer %}
<div id="notification" class="alert alert-info">Welcome to eve. This is the notification bar</div>
{% end %}

{% block scripts %}

<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
<script src="http://techanjs.org/techan.min.js"></script>
<script src="{{ static_url('portfolio/stockListings.js') }}"></script>
<script src="{{ static_url('portfolio/utils.js') }}"></script>
<script src="{{ static_url('jquery-ui.min.js') }}"></script>
<script src="{{ static_url('underscore.js') }}"></script>
<script src="{{ static_url('portfolio/controllers.js') }}"></script>
<script>
    $('#portfolioNav').addClass('active');

    /*
    var stockString = "{{jsonpickle.encode(stocks)}}".replace(/&quot;/g,'"');
    var portfolioString = "{{jsonpickle.encode(portfolios)}}".replace(/&quot;/g,'"');
    console.log(JSON.parse(stockString));
    stockListings.init({
        stocks: JSON.parse(stockString),
        portfolios: JSON.parse(portfolioString)
    });
    */

</script>

{% end %}